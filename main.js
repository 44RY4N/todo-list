(()=>{"use strict";var t={currentProject:null,allProjects:[]};function _toConsumableArray(t){return function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}(t)||function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function _unsupportedIterableToArray(t,o){if(t){if("string"==typeof t)return _arrayLikeToArray(t,o);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(t,o):void 0}}(t)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(t,o){(null==o||o>t.length)&&(o=t.length);for(var r=0,c=Array(o);r<o;r++)c[r]=t[r];return c}var o="todoList",r=function save(t){try{var r=t.map((function(t){return t.toJSON()}));return localStorage.setItem(o,JSON.stringify(r)),!0}catch(t){return console.error("Error saving to localStorage:",t),!1}},c=function load(){try{var t=localStorage.getItem(o);return t?JSON.parse(t).map((function(t){var o=createProject(t.title,t.desc);o.id=t.id,t.todos.forEach((function(t){var r=createTodo(t.title,t.description,t.duedate,t.priority,t.checked);r.id=t.id,o.add(r)}));var r=Math.max.apply(Math,[0].concat(_toConsumableArray(projects.map((function(t){return t.id}))))),c=Math.max.apply(Math,[0].concat(_toConsumableArray(projects.flatMap((function(t){return t.items.map((function(t){return t.id}))})))));return createProject.setIdCounter(r+1),createTodo.setIdCounter(c+1),o})):[]}catch(t){return console.error("Error loading from localStorage:",t),[]}};function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _defineProperties(t,o){for(var r=0;r<o.length;r++){var c=o[r];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,_toPropertyKey(c.key),c)}}function _defineProperty(t,o,r){return(o=_toPropertyKey(o))in t?Object.defineProperty(t,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[o]=r,t}function _toPropertyKey(t){var o=function _toPrimitive(t,o){if("object"!=_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var c=r.call(t,o||"default");if("object"!=_typeof(c))return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==_typeof(o)?o:o+""}var a=function(){return function _createClass(t,o,r){return o&&_defineProperties(t.prototype,o),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function Todo(t,o,r,c,a){!function _classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,Todo),this.title=t||"Note#".concat(Todo.copy++),this.description=o||"no description",this.duedate=r||"no duedate",this.priority=c||0,this.checked=a||!1,this.id=Todo.id++}),[{key:"showTodo",value:function showTodo(){!function todoShower(t){console.log("Todo Title => ".concat(t.title)),console.log("Todo description => ".concat(t.description)),console.log("Todo duedate => ".concat(t.duedate)),console.log("Todo priority => ".concat(t.priority)),console.log("Todo check status => ".concat(t.checked))}(this)}},{key:"toJSON",value:function toJSON(){return{title:this.title,description:this.description,duedate:this.duedate,priority:this.priority,checked:this.checked,id:this.id}}}])}();function createTodo(o,c,i,d,l){var u=new a(o,c,i,d,l);return addTodo(u),r(t.allProjects),u}_defineProperty(a,"copy",1),_defineProperty(a,"id",1),createTodo.setIdCounter=function(t){a.id=Math.max(a.id,t)};var i=document.querySelector("#overlay"),d=document.createElement("div"),l=document.createElement("input");l.id="popTodoTitle",l.type="text",l.maxLength="30",l.placeholder="Enter Todo Title";var u=document.createElement("textarea");u.maxLength="300",u.id="popTodoDesc",u.placeholder="Description...";var p=document.createElement("input");p.type="date",p.id="popTodoDuedate";var y=document.createElement("input");y.type="number",y.placeholder="1-9",y.max="9",y.min="1",y.id="popTodoPriority";var m=document.createElement("button"),v=null;function popTodo(){document.querySelector("#popPro").style.display="none",document.querySelector("#popTo").style.display="flex",i.style.display="flex",v=null,m.textContent="Add Todo"}m.textContent="Add Todo",m.addEventListener("click",(function(){if(y.value>9||y.value<0)alert("Enter a valid priority (1-9)");else{if(null!==v){var o;console.log("Editing todo with ID: ".concat(v));createTodo(l.value,u.value,p.value||"no duedate",y.value||0,!1);var c=null===(o=t.currentProject)||void 0===o?void 0:o.items.find((function(t){return t.id===v})),a=document.querySelector('[data-todo-id="'.concat(v,'"]'));console.log("Old todo:",c),console.log("Old todo element:",a),c&&a?(deleteTodo(c,a),r(t.allProjects)):console.error("Failed to find old todo or element for deletion:",{oldTodo:c,oldTodoElement:a}),v=null,m.textContent="Add Todo"}else console.log("Creating new todo"),createTodo(l.value,u.value,p.value||"no duedate",y.value||0,!1);i.style.display="none",l.value="",u.value="",p.value="",y.value=""}})),d.appendChild(l),d.appendChild(u),d.appendChild(p),d.appendChild(y),d.appendChild(m),i.addEventListener("click",(function(){i.style.display="none",v=null,m.textContent="Add Todo"})),d.id="popTo",i.appendChild(d),d.addEventListener("click",(function(t){return t.stopPropagation()}));var h=document.querySelector("#content"),j=document.querySelector("#overlay");function addTodo(o){var c=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(c){if(!t.currentProject||"string"==typeof t.currentProject)return void console.error("No valid project selected.");t.currentProject.add(o)}console.log("adding todo to dom"),console.log(c),c&&(console.log("state.currentProject.length = ".concat(t.currentProject.items.length)),1==t.currentProject.items.length&&(h.innerHTML=""));var a=document.createElement("div");a.classList.add("todoContainer");var i=document.createElement("div");i.classList.add("todoTitle");var d=document.createElement("div");d.classList.add("todoDesc");var l=document.createElement("div");l.classList.add("todoDuedate");var u=document.createElement("div");u.classList.add("todoPriority");var p=document.createElement("div");p.classList.add("todoChecked"),i.textContent=o.title,d.textContent=o.description,d.addEventListener("click",(function(){console.log("descn clicked"),j.style.display="flex",console.log("overlay changed");var t=document.querySelector("#popPro"),r=document.querySelector("#popTo");t.style.display="none",r.style.display="none";var c=document.createElement("div");c.id="fulldesc",c.textContent=o.description,j.appendChild(c),j.addEventListener("click",(function(){c.style.display="none",j.style.display="none"}))})),l.textContent=o.duedate,u.textContent="Priority: ".concat(o.priority),p.textContent="currently: Incomplete",a.classList.add("incomplete");var y=o.priority;y>6&&y<10?a.classList.add("high"):y>3&&y<7?a.classList.add("med"):a.classList.add("low");var P=document.createElement("div");P.textContent="*click on description to expand it",P.id="opts";var T=document.createElement("div");T.id="del",T.textContent="❌",a.dataset.todoId=o.id,T.addEventListener("click",(function(){P.classList.contains("disabled")||(deleteTodo(o,a),r(t.allProjects))})),P.appendChild(T);var g=document.createElement("div");g.id="edit",g.textContent="✏️",g.addEventListener("click",(function(){P.classList.contains("disabled")||function editTodo(t){popTodo(),v=t.id,m.textContent="Done",document.querySelector("#popTodoTitle").value=t.title,document.querySelector("#popTodoDesc").value=t.description,document.querySelector("#popTodoDuedate").value="no duedate"===t.duedate||isNaN(t.duedate)?"":new Date(t.duedate).toISOString().split("T")[0],document.querySelector("#popTodoPriority").value=t.priority}(o)})),P.appendChild(g),p.addEventListener("click",(function(t){if(t.currentTarget.parentElement.classList.contains("complete"))return t.currentTarget.parentElement.classList.add("incomplete"),t.currentTarget.parentElement.classList.remove("complete"),t.currentTarget.textContent="currently: Incomplete",P.classList.remove("disabled"),void(o.checked=!1);t.currentTarget.parentElement.classList.remove("incomplete"),t.currentTarget.parentElement.classList.add("complete"),t.currentTarget.textContent="currently: Completed",P.classList.add("disabled"),o.checked=!0})),o.checked&&(a.classList.remove("incomplete"),a.classList.add("complete"),p.textContent="currently: Completed",P.classList.add("disabled")),a.appendChild(i),a.appendChild(d),a.appendChild(l),a.appendChild(u),a.appendChild(p),a.appendChild(P),h.appendChild(a)}function deleteTodo(o,r){t.currentProject&&"string"!=typeof t.currentProject?(t.currentProject.items=t.currentProject.items.filter((function(t){return t.id!==o.id})),r.remove(),0===t.currentProject.items.length&&(h.textContent="No todos in this project.")):console.error("No valid project selected.")}function _createForOfIteratorHelper(t,o){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function displayTodos_unsupportedIterableToArray(t,o){if(t){if("string"==typeof t)return displayTodos_arrayLikeToArray(t,o);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?displayTodos_arrayLikeToArray(t,o):void 0}}(t))||o&&t&&"number"==typeof t.length){r&&(t=r);var c=0,a=function F(){};return{s:a,n:function n(){return c>=t.length?{done:!0}:{done:!1,value:t[c++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,d=!0,l=!1;return{s:function s(){r=r.call(t)},n:function n(){var t=r.next();return d=t.done,t},e:function e(t){l=!0,i=t},f:function f(){try{d||null==r.return||r.return()}finally{if(l)throw i}}}}function displayTodos_arrayLikeToArray(t,o){(null==o||o>t.length)&&(o=t.length);for(var r=0,c=Array(o);r<o;r++)c[r]=t[r];return c}var P=document.querySelector("#content");var T=document.querySelector("#projectContainer");function addProject(o){var c=document.createElement("div");c.classList.add("projectTitle"),c.textContent=o.title,c.dataset.projectId=o.id,r(t.allProjects),c.addEventListener("click",(function(o){var r;o.currentTarget.dataset.projectId!=(null===(r=t.currentProject)||void 0===r?void 0:r.id)&&(console.log("event listner added"),function displayTodos(o){P.innerHTML="";var r=Number(o.currentTarget.dataset.projectId),c=t.allProjects.find((function(t){return t.id===r}));if(!c)return console.error("Project not found for ID:",r),void(P.textContent="Project not found.");if(0===c.items.length)P.textContent="No todos in this project.";else{var a,i=_createForOfIteratorHelper(c.items);try{for(i.s();!(a=i.n()).done;)addTodo(a.value,!1)}catch(t){i.e(t)}finally{i.f()}}t.currentProject=c,console.log("Project found",c.title)}(o))})),T.appendChild(c)}function createProject_typeof(t){return createProject_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},createProject_typeof(t)}function createProject_createForOfIteratorHelper(t,o){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function createProject_unsupportedIterableToArray(t,o){if(t){if("string"==typeof t)return createProject_arrayLikeToArray(t,o);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?createProject_arrayLikeToArray(t,o):void 0}}(t))||o&&t&&"number"==typeof t.length){r&&(t=r);var c=0,a=function F(){};return{s:a,n:function n(){return c>=t.length?{done:!0}:{done:!1,value:t[c++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,d=!0,l=!1;return{s:function s(){r=r.call(t)},n:function n(){var t=r.next();return d=t.done,t},e:function e(t){l=!0,i=t},f:function f(){try{d||null==r.return||r.return()}finally{if(l)throw i}}}}function createProject_arrayLikeToArray(t,o){(null==o||o>t.length)&&(o=t.length);for(var r=0,c=Array(o);r<o;r++)c[r]=t[r];return c}function createProject_defineProperties(t,o){for(var r=0;r<o.length;r++){var c=o[r];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,createProject_toPropertyKey(c.key),c)}}function createProject_defineProperty(t,o,r){return(o=createProject_toPropertyKey(o))in t?Object.defineProperty(t,o,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[o]=r,t}function createProject_toPropertyKey(t){var o=function createProject_toPrimitive(t,o){if("object"!=createProject_typeof(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var c=r.call(t,o||"default");if("object"!=createProject_typeof(c))return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===o?String:Number)(t)}(t,"string");return"symbol"==createProject_typeof(o)?o:o+""}var g=function(){return function createProject_createClass(t,o,r){return o&&createProject_defineProperties(t.prototype,o),r&&createProject_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function Project(t,o){!function createProject_classCallCheck(t,o){if(!(t instanceof o))throw new TypeError("Cannot call a class as a function")}(this,Project),this.title=t||"Project#".concat(Project.copy++),this.desc=o||"no description",this.items=[],this.id=Project.id++}),[{key:"showProject",value:function showProject(){!function projectShower(t){console.log("Project Title => ".concat(t.title)),console.log("Project desc => ".concat(t.desc)),console.log("Project items");var o,r=createProject_createForOfIteratorHelper(t.items);try{for(r.s();!(o=r.n()).done;){var c=o.value;console.log(c.title)}}catch(t){r.e(t)}finally{r.f()}}(this)}},{key:"add",value:function add(t){this.items.push(t)}},{key:"toJSON",value:function toJSON(){return{title:this.title,desc:this.desc,id:this.id,todos:this.items.map((function(t){return t.toJSON()}))}}}])}();function createProject(o,r){var c=new g(o,r);return t.allProjects.push(c),addProject(c),c}createProject_defineProperty(g,"copy",1),createProject_defineProperty(g,"id",1),createProject.setIdCounter=function(t){g.id=Math.max(g.id,t)};var b=document.querySelector("#overlay"),S=document.createElement("div"),C=document.createElement("input"),E=document.createElement("textarea"),L=document.createElement("button");C.type="text",C.placeholder="Enter project title",E.placeholder="desc...",L.textContent="Add Project",L.addEventListener("click",(function(){createProject(C.value,E.value),b.style.display="none",C.value="",E.value=""})),S.appendChild(C),S.appendChild(E),S.appendChild(L),b.addEventListener("click",(function(){b.style.display="none"})),S.id="popPro",b.appendChild(S),S.addEventListener("click",(function(t){return t.stopPropagation()}));var _=document.querySelector("#content");var k=document.querySelector("#content");var w=document.querySelector("#content");var x=document.querySelector("header"),A=document.createElement("h1");if(A.textContent="Your Digital Todo-List",x.appendChild(A),t.allProjects=c(),0===t.allProjects.length){var I=createProject("",""),q=createTodo("","example project","","",!1);I.addTodo(q),t.allProjects.push(I),r(t.allProjects)}console.log("all projects in index"),document.querySelector("#project").addEventListener("click",(function popProject(){document.querySelector("#popTo").style.display="none",document.querySelector("#popPro").style.display="flex",b.style.display="flex"})),document.querySelector("#newtodo").addEventListener("click",popTodo),document.querySelector("#daily").addEventListener("click",(function showTodayTodos(){var o=(new Date).toISOString().split("T")[0];if(!t.currentProject||"string"==typeof t.currentProject)return console.error("No valid project selected."),void(_.innerHTML="Please select a project to view today's todos.");var r=t.allProjects.flatMap((function(t){return t.items.filter((function(t){return!("no duedate"===t.duedate||!t.duedate)&&(isNaN(t.duedate)?t.duedate:new Date(t.duedate).toISOString().split("T")[0])===o}))}));_.innerHTML="",0===r.length?_.textContent="No todos due today.":r.forEach((function(t){addTodo(t,!1)}))})),document.querySelector("#weekly").addEventListener("click",(function showWeeklyTodos(){var o=new Date,r=o.getDay(),c=new Date(o);c.setDate(o.getDate()-(0===r?6:r-1)),c.setHours(0,0,0,0);var a=new Date(c);a.setDate(c.getDate()+6),a.setHours(23,59,59,999);var i=t.allProjects.flatMap((function(t){return t.items.filter((function(t){if("no duedate"===t.duedate||!t.duedate)return!1;var o=(isNaN(t.duedate),new Date(t.duedate));return o>=c&&o<=a}))}));k.innerHTML="",0===i.length?k.textContent="No todos due this week.":i.forEach((function(t){addTodo(t,!1)}))})),document.querySelector("#all").addEventListener("click",(function displayAllTodos(){if(!t.currentProject||"string"==typeof t.currentProject)return console.error("No valid project selected."),void(w.innerHTML="Please select a project to view todos.");w.innerHTML="",0===t.currentProject.items.length?w.textContent="No todos in this project.":t.currentProject.items.forEach((function(t){addTodo(t,!1)}))})),document.querySelector("#delProject").addEventListener("click",(function deleteProject(){if(t.currentProject){var o=document.querySelector("#projectContainer");if(o){var c=o.querySelector('[data-project-id="'.concat(t.currentProject.id,'"]'));c&&c.remove()}t.allProjects=t.allProjects.filter((function(o){return o.id!==t.currentProject.id})),t.currentProject=t.allProjects[0]||null;var a=document.querySelector("#content");a&&(a.innerHTML="",t.currentProject?t.currentProject.items.forEach((function(t){addTodo(t,!1)})):a.textContent="No project selected."),r(t.allProjects)}else console.warn("No project selected to delete.")})),document.querySelector("#projectContainer div").click()})();
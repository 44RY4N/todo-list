(()=>{"use strict";const e={currentProject:"null",allProjects:[]};class t{static copy=1;static id=1;constructor(e,o,n,d,c){this.title=e||"Note#"+t.copy++,this.description=o||"no description",this.duedate=n||"no duedate",this.priority=d||0,this.checked=c||!1,this.id=t.id++}showTodo(){var e;e=this,console.log(`Todo Title => ${e.title}`),console.log(`Todo description => ${e.description}`),console.log(`Todo duedate => ${e.duedate}`),console.log(`Todo priority => ${e.priority}`),console.log(`Todo check status => ${e.checked}`)}}function o(e,o,n,d,c){let r=new t(e,o,n,d,c);return y(r),r}const n=document.querySelector("#overlay"),d=document.createElement("div"),c=document.createElement("input");c.id="popTodoTitle",c.type="text",c.maxLength="30",c.placeholder="Enter Todo Title";const r=document.createElement("textarea");r.maxLength="300",r.id="popTodoDesc",r.placeholder="Description...";const l=document.createElement("input");l.type="date",l.id="popTodoDuedate";const i=document.createElement("input");i.type="number",i.placeholder="1-9",i.max="9",i.min="1",i.id="popTodoPriority";const s=document.createElement("button");let a=null;function u(){document.querySelector("#popPro").style.display="none",document.querySelector("#popTo").style.display="flex",n.style.display="flex",a=null,s.textContent="Add Todo"}s.textContent="Add Todo",s.addEventListener("click",(()=>{if(i.value>9||i.value<0)alert("Enter a valid priority (1-9)");else{if(null!==a){console.log(`Editing todo with ID: ${a}`),o(c.value,r.value,l.value||"no duedate",i.value||0,!1);const t=e.currentProject?.items.find((e=>e.id===a)),n=document.querySelector(`[data-todo-id="${a}"]`);console.log("Old todo:",t),console.log("Old todo element:",n),t&&n?v(t,n):console.error("Failed to find old todo or element for deletion:",{oldTodo:t,oldTodoElement:n}),a=null,s.textContent="Add Todo"}else console.log("Creating new todo"),o(c.value,r.value,l.value||"no duedate",i.value||0,!1);n.style.display="none",c.value="",r.value="",l.value="",i.value=""}})),d.appendChild(c),d.appendChild(r),d.appendChild(l),d.appendChild(i),d.appendChild(s),n.addEventListener("click",(()=>{n.style.display="none",a=null,s.textContent="Add Todo"})),d.id="popTo",n.appendChild(d),d.addEventListener("click",(e=>e.stopPropagation()));const p=document.querySelector("#content"),m=document.querySelector("#overlay");function y(t,o=!0){if(o){if(!e.currentProject||"string"==typeof e.currentProject)return void console.error("No valid project selected.");e.currentProject.items.push(t)}console.log("adding todo to dom"),console.log(o),o&&(console.log(`state.currentProject.length = ${e.currentProject.items.length}`),1==e.currentProject.items.length&&(p.innerHTML=""));const n=document.createElement("div");n.classList.add("todoContainer");const d=document.createElement("div");d.classList.add("todoTitle");const c=document.createElement("div");c.classList.add("todoDesc");const r=document.createElement("div");r.classList.add("todoDuedate");const l=document.createElement("div");l.classList.add("todoPriority");const i=document.createElement("div");i.classList.add("todoChecked"),d.textContent=t.title,c.textContent=t.description,c.addEventListener("click",(()=>{console.log("descn clicked"),m.style.display="flex",console.log("overlay changed");const e=document.querySelector("#popPro"),o=document.querySelector("#popTo");e.style.display="none",o.style.display="none";const n=document.createElement("div");n.id="fulldesc",n.textContent=t.description,m.appendChild(n),m.addEventListener("click",(()=>{n.style.display="none",m.style.display="none"}))})),r.textContent=t.duedate,l.textContent=`Priority: ${t.priority}`,i.textContent="currently: Incomplete",n.classList.add("incomplete");let y=t.priority;y>6&&y<10?n.classList.add("high"):y>3&&y<7?n.classList.add("med"):n.classList.add("low");const h=document.createElement("div");h.textContent="*click on description to expand it",h.id="opts";const g=document.createElement("div");g.id="del",g.textContent="❌",n.dataset.todoId=t.id,g.addEventListener("click",(()=>{h.classList.contains("disabled")||v(t,n)})),h.appendChild(g);const C=document.createElement("div");C.id="edit",C.textContent="✏️",C.addEventListener("click",(()=>{h.classList.contains("disabled")||function(e){u(),a=e.id,s.textContent="Done",document.querySelector("#popTodoTitle").value=e.title,document.querySelector("#popTodoDesc").value=e.description,document.querySelector("#popTodoDuedate").value="no duedate"===e.duedate||isNaN(e.duedate)?"":new Date(e.duedate).toISOString().split("T")[0],document.querySelector("#popTodoPriority").value=e.priority}(t)})),h.appendChild(C),i.addEventListener("click",(e=>{if(e.currentTarget.parentElement.classList.contains("complete"))return e.currentTarget.parentElement.classList.add("incomplete"),e.currentTarget.parentElement.classList.remove("complete"),e.currentTarget.textContent="currently: Incomplete",h.classList.remove("disabled"),void(t.checked=!1);e.currentTarget.parentElement.classList.remove("incomplete"),e.currentTarget.parentElement.classList.add("complete"),e.currentTarget.textContent="currently: Completed",h.classList.add("disabled"),t.checked=!0})),t.checked&&(n.classList.remove("incomplete"),n.classList.add("complete"),i.textContent="currently: Completed",h.classList.add("disabled")),n.appendChild(d),n.appendChild(c),n.appendChild(r),n.appendChild(l),n.appendChild(i),n.appendChild(h),p.appendChild(n)}function v(t,o){e.currentProject&&"string"!=typeof e.currentProject?(e.currentProject.items=e.currentProject.items.filter((e=>e.id!==t.id)),o.remove(),0===e.currentProject.items.length&&(p.textContent="No todos in this project.")):console.error("No valid project selected.")}const h=document.querySelector("#content"),g=document.querySelector("#projectContainer");class C{static copy=1;static id=1;constructor(e,t){this.title=e||"Project#"+C.copy++,this.desc=t||"no description",this.items=[],this.id=C.id++}showProject(){!function(e){console.log(`Project Title => ${e.title}`),console.log(`Project desc => ${e.desc}`),console.log("Project items");for(const t of e.items)console.log(t.title)}(this)}add(e){this.items.push(e)}}function j(t,o){let n=new C(t,o);return function(t){const o=document.createElement("div");o.classList.add("projectTitle"),o.textContent=t.title,o.dataset.projectId=t.id,o.addEventListener("click",(t=>{t.currentTarget.dataset.projectId!=e.currentProject.id&&(console.log("event listner added"),function(t){h.innerHTML="";const o=Number(t.currentTarget.dataset.projectId),n=e.allProjects.find((e=>e.id===o));if(!n)return console.error("Project not found for ID:",o),void(h.textContent="Project not found.");if(0===n.items.length)h.textContent="No todos in this project.";else for(let e of n.items)y(e,!1);e.currentProject=n,console.log("Project found",n.title)}(t))})),g.appendChild(o)}(n),e.allProjects.push(n),n}const f=document.querySelector("#overlay"),E=document.createElement("div"),T=document.createElement("input"),L=document.createElement("textarea"),P=document.createElement("button");T.type="text",T.placeholder="Enter project title",L.placeholder="desc...",P.textContent="Add Project",P.addEventListener("click",(()=>{j(T.value,L.value),f.style.display="none",T.value="",L.value=""})),E.appendChild(T),E.appendChild(L),E.appendChild(P),f.addEventListener("click",(()=>{f.style.display="none"})),E.id="popPro",f.appendChild(E),E.addEventListener("click",(e=>e.stopPropagation()));const x=document.querySelector("#content"),S=document.querySelector("#content"),k=document.querySelector("#content"),q=document.querySelector("header"),D=document.createElement("h1");D.textContent="Your Digital Todo-List",q.appendChild(D);let w=j("",""),N=o("","example project","","","");w.add(N),console.log("all projects in index"),document.querySelector("#project").addEventListener("click",(function(){document.querySelector("#popTo").style.display="none",document.querySelector("#popPro").style.display="flex",f.style.display="flex"})),document.querySelector("#newtodo").addEventListener("click",u),document.querySelector("#daily").addEventListener("click",(function(){const t=(new Date).toISOString().split("T")[0];if(!e.currentProject||"string"==typeof e.currentProject)return console.error("No valid project selected."),void(x.innerHTML="Please select a project to view today's todos.");const o=e.allProjects.flatMap((e=>e.items.filter((e=>!("no duedate"===e.duedate||!e.duedate)&&(isNaN(e.duedate)?e.duedate:new Date(e.duedate).toISOString().split("T")[0])===t))));x.innerHTML="",0===o.length?x.textContent="No todos due today.":o.forEach((e=>{y(e,!1)}))})),document.querySelector("#weekly").addEventListener("click",(function(){const t=new Date,o=t.getDay(),n=new Date(t);n.setDate(t.getDate()-(0===o?6:o-1)),n.setHours(0,0,0,0);const d=new Date(n);d.setDate(n.getDate()+6),d.setHours(23,59,59,999);const c=e.allProjects.flatMap((e=>e.items.filter((e=>{if("no duedate"===e.duedate||!e.duedate)return!1;const t=(isNaN(e.duedate),new Date(e.duedate));return t>=n&&t<=d}))));S.innerHTML="",0===c.length?S.textContent="No todos due this week.":c.forEach((e=>{y(e,!1)}))})),document.querySelector("#all").addEventListener("click",(function(){if(!e.currentProject||"string"==typeof e.currentProject)return console.error("No valid project selected."),void(k.innerHTML="Please select a project to view todos.");k.innerHTML="",0===e.currentProject.items.length?k.textContent="No todos in this project.":e.currentProject.items.forEach((e=>{y(e,!1)}))})),document.querySelector("#projectContainer div").click()})();